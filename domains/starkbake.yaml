name: "starbake"
directory: incoming/starbake
schemas:
  - name: "Customers"
    pattern: "customers-.*.csv"
    primaryKey: customer_id
    metadata:
      mode: "FILE"
      format: "DSV"
      withHeader: true
      separator: ","
      write: "TODO"
    attributes:
      - name: "customer_id"
        type: "int"
        required: true
      - name: "first_name"
        type: "string"
        required: true
      - name: "last_name"
        type: "string"
        required: true
      - name: "email"
        type: "string"
        required: true
      - name: "join_date"
        type: "date"
        required: true
  - name: "Orders"
    pattern: "orders-.*.json"
    primaryKey: order_id
    metadata:
      mode: "FILE"
      format: "JSON"
      array: true
      write: "TODO"
    attributes:
      - name: "order_id"
        type: "int"
        required: true
      - name: "customer_id"
        type: "int"
        foreignKey: "Customers.customer_id"
        required: true
      - name: "timestamp"
        type: "datetime"
        required: true
      - name: "status"
        type: "string"
        required: true
      - name: "products"
        type: "struct"
        array: true
        required: true
        attributes:
          - name: "product_id"
            type: "int"
            required: true
          - name: "quantity"
            type: "int"
            required: false
          - name: "price"
            type: "int"
            required: true
  - name: "Products"
    pattern: "products-.*.json"
    primaryKey: product_id
    metadata:
      mode: "FILE"
      format: "JSON_ND"
      write: "APPEND"
    attributes:
      - name: "product_id"
        type: "int"
        required: true
      - name: "name"
        type: "string"
        required: true
      - name: "details"
        type: "struct"
        required: true
        attributes:
          - name: "price"
            type: "int"
            required: true
          - name: "description"
            type: "string"
            required: false
          - name: "category"
            type: "string"
            required: false
      - name: "ingredients"
        type: "struct"
        array: true
        required: true
        attributes:
          - name: "ingredient_id"
            foreignKey: "Ingredients.ingredient_id"
            type: "int"
            required: true
          - name: "quantity"
            type: "int"
            required: true
  - name: "Ingredients"
    pattern: "ingredients-.*.csv"
    primaryKey: ingredient_id
    metadata:
      mode: "FILE"
      format: "DSV"
      withHeader: true
      separator: "|"
      write: "TODO"
    attributes:
      - name: "ingredient_id"
        type: "int"
        required: true
      - name: "name"
        type: "string"
        required: true
      - name: "price"
        type: "decimal"
        required: true
      - name: "quantity_in_stock"
        type: "decimal"
        required: true